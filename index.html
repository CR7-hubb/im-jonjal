<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ìŠˆí¼ê°“ RPG v6 ì•ˆì •í™” + íšŒí”¼</title>
<style>
html,body{margin:0;overflow:hidden;background:#000;}
canvas{display:block;margin:auto;border:3px solid #fff;background:#1b5e20;}
#ui{position:absolute;top:10px;left:10px;color:white;font-family:"Press Start 2P",monospace;font-size:12px;text-shadow:1px 1px 2px black;}
#msgBox{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);width:80%;background:rgba(0,0,0,0.6);color:white;font-family:"Press Start 2P",monospace;font-size:11px;padding:15px;border:2px solid white;border-radius:10px;display:none;}
</style>
</head>
<body>
<canvas id="gameCanvas" width="960" height="640"></canvas>
<div id="ui">â¤ï¸ HP: <span id="hp">100</span> | ğŸ”¥ MP: <span id="mp">50</span> | ğŸ’° Gold: <span id="gold">0</span> | Shift: íšŒí”¼</div>
<div id="msgBox"></div>
<script>
// ===========================
// ì„¤ì •
// ===========================
const canvas=document.getElementById("gameCanvas");
const ctx=canvas.getContext("2d");
const hpUI=document.getElementById("hp");
const mpUI=document.getElementById("mp");
const goldUI=document.getElementById("gold");
const msgBox=document.getElementById("msgBox");

const TILE=32, MAP_W=30, MAP_H=20;
let keys={};

// ===========================
// í”Œë ˆì´ì–´
// ===========================
const player={x:5,y:5,hp:100,mp:50,gold:0,speed:2,dodge:false,alive:true,anim:0,dir:0};
const playerImg=new Image();
playerImg.src="https://i.ibb.co/ZYW3VTp/brown-brim.png"; // ì„ì‹œ ì•ˆì • ì´ë¯¸ì§€

// ===========================
// ë§µ ìƒì„±
// ===========================
const map=[]; for(let y=0;y<MAP_H;y++){const row=[]; for(let x=0;x<MAP_W;x++){row.push(0);} map.push(row);}

// ===========================
// ëª¬ìŠ¤í„°
// ===========================
const monsters=[{x:15,y:10,hp:30,atk:5},{x:20,y:15,hp:40,atk:8}];
const boss={x:25,y:5,hp:100,atk:15,alive:true};

// ===========================
// í‚¤ ì…ë ¥
// ===========================
window.addEventListener("keydown",e=>keys[e.key]=true);
window.addEventListener("keyup",e=>keys[e.key]=false);

// ===========================
// ì „íˆ¬
// ===========================
function checkCombat(){
    for(let m of monsters){
        if(m.hp<=0) continue;
        let dx=Math.abs(player.x-m.x), dy=Math.abs(player.y-m.y);
        if(dx<1 && dy<1){
            if(!player.dodge){player.hp-=m.atk; showMsg("ëª¬ìŠ¤í„° ê³µê²©!");}
        }
    }
    if(boss.alive){
        let dx=Math.abs(player.x-boss.x), dy=Math.abs(player.y-boss.y);
        if(dx<1 && dy<1){
            if(!player.dodge){player.hp-=boss.atk; showMsg("ë³´ìŠ¤ ê³µê²©!");}
        }
    }
}

// ===========================
// UI ë©”ì‹œì§€
// ===========================
let msgTimer=null;
function showMsg(txt){
    msgBox.textContent=txt;
    msgBox.style.display="block";
    if(msgTimer) clearTimeout(msgTimer);
    msgTimer=setTimeout(()=>{msgBox.style.display="none";},1500);
}

// ===========================
// ì—…ë°ì´íŠ¸
// ===========================
function update(){
    if(!player.alive) return;

    let speed=player.speed;
    player.dodge=keys["Shift"];

    if(keys["ArrowUp"] && player.y>0) player.y -= speed/4;
    if(keys["ArrowDown"] && player.y<MAP_H-1) player.y += speed/4;
    if(keys["ArrowLeft"] && player.x>0) player.x -= speed/4;
    if(keys["ArrowRight"] && player.x<MAP_W-1) player.x += speed/4;

    checkCombat();
    if(player.hp<=0){player.hp=0;player.alive=false; showMsg("ğŸ’€ ê²Œì„ ì˜¤ë²„");}
}

// ===========================
// ê·¸ë¦¬ê¸°
// ===========================
function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    // ë§µ
    for(let y=0;y<MAP_H;y++){
        for(let x=0;x<MAP_W;x++){
            ctx.fillStyle="#1b5e20";
            ctx.fillRect(x*TILE,y*TILE,TILE,TILE);
        }
    }
    // ëª¬ìŠ¤í„°
    ctx.fillStyle="red";
    for(let m of monsters){if(m.hp>0) ctx.fillRect(m.x*TILE,m.y*TILE,TILE,TILE);}
    // ë³´ìŠ¤
    if(boss.alive) ctx.fillStyle="purple",ctx.fillRect(boss.x*TILE,boss.y*TILE,TILE,TILE);
    // í”Œë ˆì´ì–´
    ctx.drawImage(playerImg,player.x*TILE,player.y*TILE,TILE,TILE);
}

// ===========================
// ë£¨í”„
// ===========================
function loop(){update();draw();hpUI.textContent=Math.floor(player.hp);mpUI.textContent=Math.floor(player.mp);goldUI.textContent=Math.floor(player.gold);requestAnimationFrame(loop);}
loop();
</script>
</body>
</html>
